# Скрипт для получения DNS PTR по заданным IP подсетям.

## Общая информация
Может быть полезен при проведении аудита ИБ для обнаружения дополнительных целей.

Создавался в дополнение к https://github.com/0x566164696D/scope_csv_report.

**Особенности:**
 - работает в многопоточном режиме
 - делает DNS запросы на публичные DNS сервера и NS указанных доменов
 - распределяет нагрузку на DNS сервера в режиме round-robin
 - подсвечивает PTR, принадлежащий к интересующему домену

**Ограничения:**
 - сети больше /19 игнорируются
 - работает только с IPv4

Результатом работы скрипта будет CSV файл.

## Формирование входных данных
Для работы скрипту нужно два файла в директории **./input**

### nmap_networks_v4.txt
Список подсетей, по одной на строку. (Можно скопировать после выполнения scope_csv_report)

Пример

    92.158.1.0/24
    92.158.200.0/24

### domain_ns_info.txt
Список интересующих доменов и их NS серверов. (Можно скопировать после выполнения scope_csv_report)

Пример

    example.com,a.iana-servers.net,b.iana-servers.net
    contoso.com,ns1-205.azure-dns.com,ns2-205.azure-dns.net,ns3-205.azure-dns.org,ns4-205.azure-dns.info

## Сбока

    docker build . -t 'ptrscan'

## Запуск

    docker run --rm -t\
      -e X_THREADS=15 \
      -v "$PWD"/input:/opt/input \
      -v "$PWD"/output:/opt/output \
      ptrscan

Переменная X_THREADS указывает количество потоков для DNS запросов.
